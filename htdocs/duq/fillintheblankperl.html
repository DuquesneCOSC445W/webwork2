<!DOCTYPE html>
<html>
<head>

<script type="text/javascript" src="../js/jquery.js"></script>
<script type="text/javascript" src="js/insertKnowl.js"></script>
<script type="text/javascript" src="js/ProblemEditing.js"></script>
<script type="text/javascript" src="js/HintEditor.js"></script> 
<title>Fill in the Blanks</title> 
<style>
img
{ 
	float: left;
} 

header 
{ 
	background-color:#001455; 
	height:110px;
	border: 5px solid #333;
} 

header h1 
{ 
	color:#FFF;   
}

a : link
{ 
	decoration:none; 
}

button 
{
    background-color: #001456;
    border: 2px solid #333; 
    color: white;
    padding: 2px 8px 2px 8px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    margin:0;
    cursor: pointer;
}

#codeArea
{
	float: right;
}


#userInput
{
	position: static;
	width: 63%
}

</style>
</head> 
<body onload="restoreState()">
<script> 

function sendQuestion() 
{	
	//addKnowlHelper();
	var question = document.getElementById("question").value; 
	if(question == "") 
	{
		alert("Ooops! You left the question blank. Please try again"); 
	} 
	var output = document.getElementById("outputQues"); 
	output.innerHTML = "You asked : " +question; 
}

function sendAnswer() 
{
	var answer = document.getElementById("answer").value; 
	if(answer == "") 
	{
		alert("Ooops! You left the answer blank. Please try again"); 
	} 
	var output = document.getElementById("outputAns"); 
	output.innerHTML = "You answered : " +answer; 
}

function sendSolution() 
{
	var solution = document.getElementById("solution").value; 
	var output = document.getElementById("outputSolution"); 
	output.innerHTML = "Your solution is : "  +solution; 
}

function sendImage(){
        var output = document.getElementById("outputImage");
        var width = 500;
        var height = 500;
        if(document.getElementById("imageWidth").value != ""){
                width = document.getElementById("imageWidth").value;
        }

        if(document.getElementById("imageHeight").value != ""){
                height = document.getElementById("imageHeight").value;
        }
        output.innerHTML = "<image src=" + document.getElementById("imageText").value + 
                                " width=" + width + "px" + 
                                " height=" + height + "px>";
}

function sendHint(){
        var output = document.getElementById("outputHint");
        var width = 500;
        var height = 500;

        if(document.getElementById("imageHintWidth").value != ""){
                width = document.getElementById("imageHintWidth").value;
        }

        if(document.getElementById("imageHintHeight").value != ""){
                height = document.getElementById("imageHintHeight").value;
        }
        output.innerHTML = "<div>" + document.getElementById("hintText").value + "</div><br>" +
                                "<image src=" + document.getElementById("imageHintText").value +
                                " width=" + width + "px" + 
                                " height=" + height + "px>";
}

function generatePerl()
{
	addKnowlHelper();
	var question = document.getElementById("knowlOutput").innerHTML;
	var answer = document.getElementById("answer").value;
	var solution = document.getElementById("solution").value;

	var section1 = '<br><br>DOCUMENT();\n<br>\
	\n<br>\
	loadMacros(\n<br>\
	"PGstandard.pl",\n<br>\
	"MathObjects.pl",\n<br>\
	);\n<br>\
	\n<br>\
	TEXT(beginproblem());\n<br>\
	\n<br>\
    	Context()->strings->add("';
    
   	var section2 = '"=>{});\n<br>\
	$answer = String("';

	var section3 ='");\n<br>\
	\n<br>\
	Context()->texStrings;\n<br>\
	BEGIN_TEXT\n<br>';
	
	var section4 = "<br>$BR\n<br>\
	$BR\n<br>\
	\\{ ans_rule(20) \\}\n<br>\
	END_TEXT\n<br>\
	Context()->normalStrings;\n<br>\
	\n<br>\
	$showPartialCorrectAnswers = 1;\n<br>\
	\n<br>\
	ANS( $answer->cmp() );\n<br>\
	\n<br>\
	Context()->texStrings;\n<br>\
	SOLUTION(EV3(<<'END_SOLUTION'));\n<br>\
	$PAR SOLUTION $PAR\n<br>";
	
	var section5 = "\n<br>END_SOLUTION\n<br>\
	Context()->normalStrings;\n<br>\
	\n<br>\
	ENDDOCUMENT();";


	var pgString = section1 + answer + section2 + answer + section3 + question + section4 + answer + solution + section5;
//Quan from Team Brandon: 
//I think there is a bug in your code in the line above so I fixed it but not sure. 
//Check it please
	//Insert hint/image PG code, if there is a hint or image
        if(document.getElementById("hintText").value != "" || 
                document.getElementById("imageHintText").value != ""
                        || document.getElementById("imageText").value != ""){
                        pgString = translateToPG(pgString,
                                document.getElementById("hintText").value, 
                                        [document.getElementById("imageHintText").value, document.getElementById("imageHintWidth").value, document.getElementById("imageHintHeight").value], 
                                                [document.getElementById("imageText").value, document.getElementById("imageWidth").value, document.getElementById("imageHeight").value]);
        }

	
	var output = document.getElementById("codeOutput"); 
	output.innerHTML = "All the Perl code is : <span id='code'>"  + pgString + "</span>";
	
	// Save the state and make the updates in WebWorK
	saveState();
}

</script> 



<header> 
<h1> 
	<img src = "mlogo.png" height = 70 width = 80 float: center>
	Mathematical Association of America <br>
	WeBWorK Question Creator
</h1> 
</header><br>
<div id = "codeArea">
<fieldset>
	<legend> Click the button to see a preview of the Perl generated for this question </legend>
	<button onclick = "generatePerl()" >Submit <br></button>
	<br> 
	<div id="codeOutput">
	</div>
</div>

<div id = "userInput">
<fieldset> 
	<legend> Please type the question below : </legend> 
	<p> <textarea id ="question" class="DuqWorkSave" rows="5" cols="50"></textarea><br>
	<p id="knowlOutput" class="DuqWorkSave"></p>
	<button onclick = "sendQuestion()" >Submit <br></button> 
	<p> Question Preview </p>
	<div id = "outputQues"> 
	</div>
</fieldset> 

<fieldset>
	<legend> The answer for this question is : </legend> <br> 
	<textarea id ="answer" class="DuqWorkSave" rows="1" cols="50"></textarea><br>
	<button onclick = "sendAnswer()" >Submit <br> </button> 
	<p> Answer Preview </p> 
	<div id = "outputAns"> 
	</div>
</fieldset>

<fieldset> 
	<legend> Enter an explanation of the solution below: </legend> 
	<p> <textarea id ="solution" class="DuqWorkSave" rows="5" cols="50"></textarea><br>
	<button onclick = "sendSolution()" >Submit <br></button> 
	<p> Solution Preview </p>
	<div id = "outputSolution"> 
	</div>
</fieldset> 

<title> Knowls Creator </title>
<fieldset>
    <legend>Knowls Creator:</legend>
    
 Knowl keyword(use ^ as separator for multiple knowls)<br>
  <textarea id="theWord" class="DuqWorkSave" rows="1" cols="20"></textarea><br>
 Knowl Content: <br>
  <textarea id="theDef" class="DuqWorkSave" rows="4" cols="50"></textarea><br>
  <button onclick="addKnowlHelper()"> Add a knowl!</button>
</fieldset>

<!--HINT FIELD-->
<fieldset>
        <legend> Enter a hint below: </legend>

        <p>Enter text here:</p>
        <textarea id ="hintText" class="DuqWorkSave" rows = "5" cols = "50"></textarea>
        <br>

        <p>Enter a URL for an externally hosted image here:<br>(Default size is 500x500)</p>
        <textarea id ="imageHintText" class="DuqWorkSave" rows = "5" cols = "50"></textarea>
        <textarea id = "imageHintWidth" class="DuqWorkSave" placeholder = "width" rows = "1" cols = "7"></textarea>
        <textarea id = "imageHintHeight" class="DuqWorkSave" placeholder = "height" rows = "1" cols = "7"></textarea>
        <br>

        <button class = "button" onclick = "sendHint()">Hint preview</button>
        <p> Hint Preview </p>
        <div id = "outputHint">
        </div>
</fieldset>


<!--GRAPHICS FIELD-->
<fieldset>
        <legend> Enter a URL for an externally hosted image to show in problem below:
                <br>(Default size is 500x500)
        </legend>
        <textarea id ="imageText" class="DuqWorkSave" rows = "5" cols = "50"></textarea>
        <textarea id = "imageWidth" class="DuqWorkSave" placeholder = "width" rows = "1" cols = "7"></textarea>
        <textarea id = "imageHeight" class="DuqWorkSave" placeholder = "height" rows = "1" cols = "7"></textarea>
        <br>
        <button class = "button" onclick = "sendImage()">Image preview</button>
        <p> Image Preview </p>
        <div id = "outputImage">
        </div>
</fieldset>

</div>
</body>
</html>
